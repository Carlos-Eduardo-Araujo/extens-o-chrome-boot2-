<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bootcamp PWA</title>

    <!-- Manifest do PWA -->
    <link rel="manifest" href="manifest.webmanifest" />

    <!-- Estilo simples -->
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .card { border: 1px solid #ccc; padding: 15px; margin-top: 15px; border-radius: 8px; }
    </style>
</head>
<body>

    <h1>⭐ Bootcamp PWA</h1>
    <p>API Test + Offline Fallback</p>

    <button onclick="carregarDados()">Carregar API</button>

    <div id="resultado" class="card">Clique no botão para iniciar</div>

    <script>
        async function carregarDados() {
            const display = document.getElementById("resultado");
            
            try {
                const response = await fetch("http://localhost:3000/api/hello");
                
                if (!response.ok) throw new Error("Erro na API");

                const json = await response.json();
                display.innerHTML = `<strong>API:</strong> ${json.msg}`;

                
                localStorage.setItem("cache_api", json.msg);

            } catch (error) {
                const cache = localStorage.getItem("cache_api");

                display.innerHTML = cache
                    ? `<strong>Offline:</strong> Último valor salvo → ${cache}`
                    : `<strong>Offline:</strong> API indisponível`;
            }
        }

        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/service-worker.js")
        }
    </script>

</body>
</html>
